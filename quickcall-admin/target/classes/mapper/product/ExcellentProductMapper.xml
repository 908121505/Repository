<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ExcellentProduct">
 <resultMap id="BaseResultMap" type="com.calf.module.product.entity.ExcellentProduct" >
   <id column="excellentProduct_id" property="excellentProductId" jdbcType="VARCHAR" />
    <result column="product_id" property="productId"  />
    <result column="product_name" property="productName"  />
    <result column="product_img" property="productImg"  />
    <result column="createTime" property="createTime"  />
    <result column="startTime" property="startTime"  />
    <result column="endTime" property="endTime"  />
    <result column="modify_time" property="modifyTime"  />
    <result column="modify_man" property="modifyMan"  />
    <result column="passingRate" property="passingRate"  />
    <result column="content" property="content"  />
    <result column="status" property="status"  />
     <result column="bDelete" property="bDelete"  />
  </resultMap>

  <sql id="Base_Column_List" >
    excellentProduct_id, excellentProduct.product_id, product.product_name AS product_name, product.product_img AS product_img,
    excellentProduct.createTime, startTime, endTime,
    excellentProduct.modify_time, excellentProduct.modify_man, passingRate, content, excellentProduct.status
  </sql>
  
  <select id="get" parameterType="map" resultMap="BaseResultMap">
		select
        <include refid="Base_Column_List" />
		from excellentProduct INNER JOIN product on excellentProduct.product_id=product.product_id
		WHERE excellentProduct_id = #{arg0}
	</select>

	
  <select id="queryCount" parameterType="map" resultType="int">
		select count(product_id) from excellentProduct where 1=1
      <if test="productName !=null"> and product_name =#{productName}</if>
      <if test="status !=null"> and status = #{status}</if>
      <if test="bDelete !=null"> and bDelete = #{bDelete}</if>
	</select>

	<select id="query" parameterType="map" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from excellentProduct INNER JOIN product on excellentProduct.product_id=product.product_id
        where 1=1
		<if test="productName !=null"> and product.product_name =#{productName}</if>
		<if test="status !=null"> and excellentProduct.status = #{status}</if>
        <if test="bDelete !=null"> and bDelete = #{bDelete}</if>
        order by modify_time DESC
		limit ${iDisplayStart},${iDisplayLength}
	</select>


	<select id="queryAll" parameterType="map" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from excellentProduct where 1=1
		<if test="productId !=null"> and product_id =#{productId}</if>
		<if test="productCategoryId !=null"> and  product_category_id = #{productCategoryId} </if>
		<if test="productName !=null"> and (product_name like concat('%',#{productName},'%'))</if>
		<if test="productLabel !=null"> and (product_label like concat('%',#{productLabel},'%'))</if>
		<if test="isRecommend !=null"> and is_recommend = #{isRecommend} </if>
		<if test="state !=null"> and state = #{state}</if>
		<if test="orderStr !=null"> order by  ${orderStr} </if>
	</select>

	
	 <insert id="insert" parameterType="com.calf.module.product.entity.Product" >

       insert into excellentProduct (excellentProduct_id, product_id, product_name, product_img,createTime, startTime, endTime,
         modify_time, modify_man, passingRate, content, status,bDelete)
    values (#{excellentProductId,jdbcType=VARCHAR}, #{productId,jdbcType=VARCHAR}, #{productName,jdbcType=VARCHAR},
      #{productImg,jdbcType=VARCHAR}, #{createTime,jdbcType=VARCHAR}, #{startTime,jdbcType=VARCHAR},
      #{endTime,jdbcType=VARCHAR}, #{modifyTime,jdbcType=VARCHAR}, #{modifyMan,jdbcType=VARCHAR},
      #{passingRate,jdbcType=VARCHAR}, #{content,jdbcType=VARCHAR}, #{status,jdbcType=INTEGER},#{bDelete,jdbcType=INTEGER})
  </insert>
  
   <update id="update" parameterType="map" >
    update excellentProduct
    <set >
        <if test="excellentProductId !=null">
        excellentProduct_id = #{excellentProductId,jdbcType=VARCHAR},
        </if>
        <if test="productId !=null">
        product_id = #{productId},
        </if>
        <if test="productName !=null">
        product_name = #{productName},
        </if>
        <if test="productImg !=null">
        product_img = #{productImg},
        </if>
        <if test="createTime !=null">
        createTime = #{createTime},
        </if>
        <if test="startTime !=null">
        startTime = #{startTime},
        </if>
        <if test="endTime !=null">
            endTime = #{endTime},
        </if>
        <if test="endTime !=null">
        modify_time = #{modifyTime},
        </if>
        <if test="modifyTime !=null">
        modify_man = #{modifyMan},
        </if>
        <if test="passingRate !=null">
        passingRate = #{passingRate},
        </if>
        <if test="content !=null">
        content = #{content},
        </if>
        <if test="status !=null">
        status = #{status},
        </if>
        <if test="bDelete !=null">
        bDelete = #{bDelete}
        </if>
    </set>
     WHERE excellentProduct_id = #{excellentProductId}
  </update>
</mapper>