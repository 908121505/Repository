<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="RefInvite">
    <resultMap id="resultMap" type="RefInvite">
        <id property="refInviteId" column="ref_invite_id"/>
        <id property="refAccountId" column="ref_account_id"/>
        <id property="refPhoneNum" column="ref_phone_num"/>
        <id property="inviteAccountId" column="invite_account_id"/>
        <id property="state" column="state"/>
        <id property="phoneNum" column="phone_num"/>
        <id property="createTime" column="create_time"/>
        <id property="modifyTime" column="modify_time"/>
        <id property="remark" column="remark"/>
    </resultMap>

    <sql id="Base_Column_List">
        ref_invite_id,
        ref_account_id,
        ref_phone_num,
        phone_num,
        invite_account_id,
        state,
        DATE_FORMAT(
        create_time,
        '%Y-%c-%d %H:%i:%s'
        ) as create_time,
        DATE_FORMAT(
        modify_time,
        '%Y-%c-%d %H:%i:%s'
        ) AS modify_time,
        remark
    </sql>

    <select id="queryCount" parameterType="map" resultType="int">
        select count(ref_invite_id) from ref_invite where 1=1
        <if test="phoneNum != null">and phone_num like concat('%',#{phoneNum},'%')</if>
    </select>
    <select id="query" parameterType="map" resultMap="resultMap">
        select
        <include refid="Base_Column_List"/>
        from
        ref_invite where 1=1
        <if test="phoneNum != null">and phone_num like concat('%',#{phoneNum},'%')</if>
         <if test="refPhoneNum != null">and ref_phone_num = #{refPhoneNum}</if>
        order by create_time desc
        limit ${iDisplayStart},${iDisplayLength}
    </select>
    
     <select id="queryByRefAccountId" parameterType="map" resultMap="resultMap">
        select
        <include refid="Base_Column_List"/>
        from
        ref_invite where 
			ref_account_id=#{refAccountId}
		and remark=#{activityId}
    </select>

</mapper>
