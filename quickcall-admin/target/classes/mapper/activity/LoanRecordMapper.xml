<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="LoanRecord">
    <resultMap id="resultMap" type="LoanRecord">
        <id property="loanRecordId" column="loan_record_id"/>
        <id property="idCard" column="id_card"/>
        <id property="phoneNum" column="phone_num"/>
        <id property="state" column="state"/>
        <id property="loanQuota" column="loan_quota"/>
        <id property="platformName" column="platform_name"/>
        <id property="createTime" column="create_time"/>
        <id property="remark" column="remark"/>
        <id property="batchNumber" column="batch_number"/>
    </resultMap>

    <sql id="Base_Column_List">
        loan_record_id,
        id_card,
        phone_num,
        state,
        create_time,
        loan_quota,
        platform_name,
        batch_number,
        remark
    </sql>

    <select id="queryCount" parameterType="map" resultType="int">
        select count(loan_record_id) from loan_record where 1=1
        <if test="phoneNum != null">and phone_num like concat('%',#{phoneNum},'%')</if>
        <if test="state != null">and state = #{state}</if>
    </select>
    <select id="query" parameterType="map" resultMap="resultMap">
        select
        <include refid="Base_Column_List"/>
        from
        loan_record where 1=1
        <if test="phoneNum != null">and phone_num like concat('%',#{phoneNum},'%')</if>
        <if test="state != null">and state = #{state}</if>
        order by create_time desc
        limit ${iDisplayStart},${iDisplayLength}
    </select>

    <insert id="insert" parameterType="map">
        INSERT INTO loan_record(loan_record_id,id_card,phone_num,state,create_time,loan_quota,platform_name,batch_number,remark)
        VALUES (#{loanRecordId},#{idCard},#{phoneNum},#{state},#{createTime},#{loanQuota},#{platformName},#{batchNumber},#{remark})
    </insert>

</mapper>
